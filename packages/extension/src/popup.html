<!DOCTYPE html>
<html>
  <head>
    <title>Nostr Git Settings</title>
    <style>
      /* No-flicker hide of debug row when compile-time flag false */
      :root[hide-debug="true"] #debugRow,
      :root[hide-debug="true"] #debugHelp { display: none !important; }
      :root {
        color-scheme: light dark;
        --bg: #ffffff;
        --panel: #f6f8fa;
        --text: #24292f;
        --muted: #57606a;
        --border: #d0d7de;
        --accent: #0969da;
        --accent-contrast: #ffffff;
        --btn-bg: #f3f4f6;
        --btn-border: #d1d5db;
        --shadow: 0 1px 2px rgba(0,0,0,0.06), 0 4px 12px rgba(0,0,0,0.08);
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #0d1117;
          --panel: #161b22;
          --text: #e6edf3;
          --muted: #8b949e;
          --border: #30363d;
          --accent: #4493f8;
          --accent-contrast: #0d1117;
          --btn-bg: #21262d;
          --btn-border: #30363d;
          --shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
      }
      * { box-sizing: border-box; }
      html, body { margin: 0; padding: 0; }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        width: 340px;
        background: var(--bg);
        color: var(--text);
      }
      .wrap { padding: 12px; }
      .card {
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        box-shadow: var(--shadow);
        padding: 12px;
      }
      h3 { margin: 0 0 8px; font-size: 16px; }
      .section { margin-top: 12px; }
      label { display: block; font-weight: 600; margin-bottom: 6px; }
      input[type="url"], textarea {
        width: 100%;
        background: var(--bg);
        color: var(--text);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 8px 10px;
        outline: none;
      }
      input[type="url"]:focus, textarea:focus { border-color: var(--accent); box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 20%, transparent); }
      textarea { height: 120px; resize: vertical; }
      .row { display: flex; gap: 8px; margin-top: 8px; align-items: center; }
      .btn {
        display: inline-flex; align-items: center; justify-content: center;
        gap: 6px; padding: 8px 12px; border-radius: 8px; border: 1px solid var(--btn-border);
        background: var(--btn-bg); color: var(--text); cursor: pointer; font-weight: 600;
        transition: background 120ms ease, border-color 120ms ease, transform 80ms ease;
      }
      .btn:hover { filter: brightness(0.98); }
      .btn:active { transform: translateY(1px); }
      .btn-primary { background: var(--accent); color: var(--accent-contrast); border-color: var(--accent); }
      .btn-primary:hover { filter: brightness(0.96); }
      .muted { color: var(--muted); font-size: 12px; }
      input[aria-invalid="true"] { border-color: #e5534b !important; box-shadow: 0 0 0 3px rgba(229,83,75,0.2); }
      .actions { display:flex; gap:8px; align-items:center; }
      .btn-secondary { background: #2d2d2d; color:#fff; border:1px solid #444; }
      @media (prefers-color-scheme: light) { .btn-secondary { background:#f3f4f6; color:#111; border:1px solid #d1d5db; } }
      hr { margin: 12px 0; border: none; border-top: 1px solid var(--border); }
      .switch { display: inline-flex; gap: 8px; align-items: center; }
      #status { min-height: 1.2em; margin-top: 10px; font-size: 12px; color: var(--muted); }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card" role="region" aria-label="Nostr Git Settings">
        <h3>Nostr Relays</h3>
        <form id="relayForm">
          <div class="section">
            <label for="relayList">Relays (one per line)</label>
            <textarea
              id="relayList"
              placeholder="wss://relay.damus.io&#10;wss://relay.snort.social"
              spellcheck="false"
              autofocus
              aria-describedby="relayHelp"
            ></textarea>
            <small id="relayHelp" class="muted">Use wss:// where possible. Invalid or duplicate entries will be ignored.</small>
            <div class="row">
              <button class="btn btn-primary" id="saveBtn" type="submit">Save</button>
              <button class="btn" id="resetBtn" type="button">Reset to defaults</button>
            </div>
          </div>

          <div class="section">
            <div class="row switch" id="debugRow">
              <input type="checkbox" id="debugToggle" aria-describedby="debugHelp" />
              <label for="debugToggle" style="margin:0; font-weight:500;">Debug: console-only (donâ€™t publish to relays)</label>
            </div>
            <small id="debugHelp" class="muted">When enabled, generated events are signed and logged to the console instead of being published.</small>
          </div>

          <hr />

          <div class="section">
            <label for="viewerBase">Viewer Base URL</label>
            <div class="row actions">
              <input id="viewerBase" type="text" placeholder="https://njump.me/" aria-describedby="viewerHelp" />
              <button id="saveViewerBaseBtn" class="btn">Save</button>
              <button id="resetViewerBaseBtn" class="btn btn-secondary" title="Reset to default">Reset</button>
            </div>
            <small id="viewerHelp" class="muted">Used for snackbar links, e.g. base + nevent. Example: https://njump.me/</small>
          </div>

          <p id="status" role="status" aria-live="polite"></p>
        </form>
      </div>
    </div>
    <script src="popup.js" type="module"></script>
  </body>
</html>
